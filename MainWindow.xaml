<Window x:Class="WordWebDAV.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:tb="http://www.hardcodet.net/taskbar"
        Title="Trình chỉnh sửa Office" 
        Height="600" Width="900"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanMinimize"
        Background="Transparent"
        WindowStyle="None"
        AllowsTransparency="True"
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        StateChanged="Window_StateChanged">
    
    <Grid x:Name="MainGrid">
        <tb:TaskbarIcon x:Name="trayIcon" Visibility="Collapsed"/>
        
        <!-- Animated Border Glow -->
        <Border x:Name="glowBorder" CornerRadius="12" Padding="2">
            <Border.Background>
                <LinearGradientBrush x:Name="borderGradient" StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#6366f1" Offset="0"/>
                    <GradientStop Color="#8b5cf6" Offset="0.25"/>
                    <GradientStop Color="#d946ef" Offset="0.5"/>
                    <GradientStop Color="#f43f5e" Offset="0.75"/>
                    <GradientStop Color="#6366f1" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Border.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard>
                        <Storyboard RepeatBehavior="Forever">
                            <PointAnimation Storyboard.TargetName="borderGradient"
                                          Storyboard.TargetProperty="StartPoint"
                                          From="0,0" To="1,0" Duration="0:0:2"/>
                            <PointAnimation Storyboard.TargetName="borderGradient"
                                          Storyboard.TargetProperty="StartPoint"
                                          From="1,0" To="1,1" Duration="0:0:2" BeginTime="0:0:2"/>
                            <PointAnimation Storyboard.TargetName="borderGradient"
                                          Storyboard.TargetProperty="StartPoint"
                                          From="1,1" To="0,1" Duration="0:0:2" BeginTime="0:0:4"/>
                            <PointAnimation Storyboard.TargetName="borderGradient"
                                          Storyboard.TargetProperty="StartPoint"
                                          From="0,1" To="0,0" Duration="0:0:2" BeginTime="0:0:6"/>
                            <PointAnimation Storyboard.TargetName="borderGradient"
                                          Storyboard.TargetProperty="EndPoint"
                                          From="1,1" To="0,1" Duration="0:0:2"/>
                            <PointAnimation Storyboard.TargetName="borderGradient"
                                          Storyboard.TargetProperty="EndPoint"
                                          From="0,1" To="0,0" Duration="0:0:2" BeginTime="0:0:2"/>
                            <PointAnimation Storyboard.TargetName="borderGradient"
                                          Storyboard.TargetProperty="EndPoint"
                                          From="0,0" To="1,0" Duration="0:0:2" BeginTime="0:0:4"/>
                            <PointAnimation Storyboard.TargetName="borderGradient"
                                          Storyboard.TargetProperty="EndPoint"
                                          From="1,0" To="1,1" Duration="0:0:2" BeginTime="0:0:6"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Border.Triggers>
            
        <!-- Main Content Border -->
        <Border CornerRadius="10" BorderThickness="0">
        <Border.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#0f0f0f" Offset="0"/>
                <GradientStop Color="#1a1a2e" Offset="0.5"/>
                <GradientStop Color="#0f0f0f" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="60"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left Sidebar -->
            <Border Grid.Column="0" Background="#0c0c0c" CornerRadius="10,0,0,10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Logo/Status -->
                    <Border Grid.Row="0" Margin="0,20,0,30">
                        <Ellipse x:Name="statusCircle" Width="28" Height="28" Fill="#22c55e" HorizontalAlignment="Center">
                            <Ellipse.Triggers>
                                <EventTrigger RoutedEvent="Loaded">
                                    <BeginStoryboard>
                                        <Storyboard RepeatBehavior="Forever">
                                            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="1" To="0.5" Duration="0:0:1" AutoReverse="True"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </Ellipse.Triggers>
                        </Ellipse>
                    </Border>
                    
                    <!-- Menu Items -->
                    <StackPanel Grid.Row="1" VerticalAlignment="Top">
                        <TextBlock Text="CTRL" Foreground="#444" FontSize="9" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        
                        <Button x:Name="btnStartStop" Click="BtnStartStop_Click" Width="36" Height="36" Margin="0,5"
                                Background="Transparent" BorderThickness="0" Cursor="Hand" ToolTip="Pause/Resume">
                            <TextBlock x:Name="txtBtnIcon" Text="⏸" FontSize="16" Foreground="#888"/>
                        </Button>
                        
                        <Button x:Name="btnRestart" Click="BtnRestart_Click" Width="36" Height="36" Margin="0,5"
                                Background="Transparent" BorderThickness="0" Cursor="Hand" ToolTip="Restart Server">
                            <TextBlock Text="↻" FontSize="18" Foreground="#888"/>
                        </Button>
                        
                        <Button Click="BtnMinimize_Click" Width="36" Height="36" Margin="0,5"
                                Background="Transparent" BorderThickness="0" Cursor="Hand" ToolTip="Minimize">
                            <TextBlock Text="▬" FontSize="12" Foreground="#888"/>
                        </Button>
                        
                        <TextBlock Text="INFO" Foreground="#444" FontSize="9" HorizontalAlignment="Center" Margin="0,20,0,10"/>
                        
                        <!-- Uptime indicator -->
                        <Border Background="#1a1a1a" CornerRadius="8" Width="40" Height="40" Margin="0,5" ToolTip="Uptime">
                            <TextBlock Text="⏱" FontSize="16" Foreground="#60a5fa" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        
                        <!-- Request counter -->
                        <Border Background="#1a1a1a" CornerRadius="8" Width="40" Height="40" Margin="0,5" ToolTip="Total Requests">
                            <TextBlock Text="📊" FontSize="16" Foreground="#22c55e" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </StackPanel>
                    
                    <!-- Exit button -->
                    <Button Grid.Row="2" Click="BtnExit_Click" Width="36" Height="36" Margin="0,0,0,20"
                            Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalAlignment="Center" ToolTip="Exit">
                        <Grid Width="18" Height="18">
                            <Ellipse Stroke="#ef4444" StrokeThickness="2" Width="14" Height="14"/>
                            <Rectangle Fill="#ef4444" Width="2" Height="8" VerticalAlignment="Top" Margin="0,1,0,0"/>
                        </Grid>
                    </Button>
                </Grid>
            </Border>
            
            <!-- Main Content -->
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="50"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Title Bar -->
                <Grid Grid.Row="0" Margin="20,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Trình chỉnh sửa Office" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                        <TextBlock x:Name="txtStatus" Text="  •  Đang chạy" FontSize="14" Foreground="#22c55e" VerticalAlignment="Center"/>
                    </StackPanel>
                    
                    <!-- Window Controls -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button Click="BtnMinimize_Click" Width="30" Height="30" Background="Transparent" BorderThickness="0" Cursor="Hand">
                            <TextBlock Text="─" Foreground="#666" FontSize="12"/>
                        </Button>
                        <Button Width="30" Height="30" Background="Transparent" BorderThickness="0" Cursor="Hand">
                            <TextBlock Text="□" Foreground="#666" FontSize="12"/>
                        </Button>
                        <Button Click="BtnExit_Click" Width="30" Height="30" Background="Transparent" BorderThickness="0" Cursor="Hand">
                            <TextBlock Text="✕" Foreground="#666" FontSize="12"/>
                        </Button>
                    </StackPanel>
                </Grid>
                
                <!-- Content Area -->
                <Grid Grid.Row="1" Margin="20,0,20,20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Info Cards -->
                    <Grid Grid.Row="0" Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <Border Grid.Column="0" Background="#141414" CornerRadius="8" Padding="15" Margin="0,0,6,0">
                            <StackPanel>
                                <TextBlock Text="PORT" Foreground="#555" FontSize="10" FontWeight="Bold"/>
                                <TextBlock x:Name="txtPort" Text="1901" Foreground="White" FontSize="24" FontWeight="Bold" Margin="0,5,0,0"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="1" Background="#141414" CornerRadius="8" Padding="15" Margin="6,0">
                            <StackPanel>
                                <TextBlock Text="STATUS" Foreground="#555" FontSize="10" FontWeight="Bold"/>
                                <TextBlock x:Name="txtStatusCard" Text="RUNNING" Foreground="#22c55e" FontSize="18" FontWeight="Bold" Margin="0,5,0,0"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="2" Background="#141414" CornerRadius="8" Padding="15" Margin="6,0">
                            <StackPanel>
                                <TextBlock Text="REQUESTS" Foreground="#555" FontSize="10" FontWeight="Bold"/>
                                <TextBlock x:Name="txtRequests" Text="0" Foreground="White" FontSize="24" FontWeight="Bold" Margin="0,5,0,0"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="3" Background="#141414" CornerRadius="8" Padding="15" Margin="6,0,0,0">
                            <StackPanel>
                                <TextBlock Text="UPTIME" Foreground="#555" FontSize="10" FontWeight="Bold"/>
                                <TextBlock x:Name="txtUptime" Text="00:00:00" Foreground="#60a5fa" FontSize="16" FontWeight="SemiBold" Margin="0,8,0,0" FontFamily="Consolas"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                    
                    <!-- Log Panel -->
                    <Border Grid.Row="1" Background="#0a0a0a" CornerRadius="8">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <Border Grid.Row="0" BorderBrush="#1a1a1a" BorderThickness="0,0,0,1" Padding="15,12">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="CONSOLE OUTPUT" Foreground="#555" FontSize="10" FontWeight="Bold"/>
                                        <TextBlock Text="  •  " Foreground="#333"/>
                                        <TextBlock x:Name="txtApi" Text="localhost:3156" Foreground="#60a5fa" FontSize="10" FontFamily="Consolas"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                        <Button Click="BtnCopyApi_Click" Background="Transparent" BorderThickness="0" Cursor="Hand" Padding="8,2" ToolTip="Copy API URL">
                                            <TextBlock Text="📋" FontSize="12"/>
                                        </Button>
                                        <Button Click="BtnClearLog_Click" Background="Transparent" BorderThickness="0" Cursor="Hand" Padding="8,2" ToolTip="Clear Log">
                                            <TextBlock Text="🗑" FontSize="12"/>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </Border>
                            
                            <ScrollViewer x:Name="logScroller" Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <TextBox x:Name="txtLog" Foreground="#888" Background="Transparent" BorderThickness="0"
                                         FontFamily="Consolas" FontSize="12" Padding="15" TextWrapping="Wrap"
                                         IsReadOnly="True" AcceptsReturn="True"/>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                    
                    <!-- Footer with Auto-start -->
                    <Grid Grid.Row="2" Margin="0,12,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="v1.0.0  •  © 2024 LifeTex" Foreground="#333" FontSize="10" VerticalAlignment="Center"/>
                        
                        <CheckBox x:Name="chkAutoStart" Grid.Column="1" Content=" Khởi động cùng Windows" 
                                  Foreground="#555" FontSize="11" VerticalAlignment="Center"
                                  Checked="ChkAutoStart_Changed" Unchecked="ChkAutoStart_Changed"/>
                    </Grid>
                </Grid>
            </Grid>
        </Grid>
    </Border>
    </Border>
    </Grid>
</Window>
